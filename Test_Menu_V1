function Get-MailboxAccess {
    Connect-ExchangeOnline

    #Enter UPN of Email you wish to list the access they have
    $UPN = Read-Host "Enter Email you wish to see the access list to"

    #List all access user mentioned above has access to read.
    Get-EXOMailbox -ResultSize Unlimited | Get-EXOMailboxPermission -Identity $_.Identity | Where-Object {$_.User -eq $UPN}
}




function Get-MailboxForwardedTo {
    Connect-ExchangeOnline 

    #Specify email address in question.
    $UPN = Read-Host "Enter email address to see what is forwarding to it" 
    
    #Convert UPN to Identity.
    $RecipientIdentity=(Get-Recipient $UPN ).Identity  
    
    #List all mailboxes forwarded to identity listed above.
    Get-Mailbox | Where-Object {($_.ForwardingAddress -eq $RecipientIdentity) -or ($_.ForwardingSMTPAddress -match $UPN) } | Select-Object Name, Alias 
}





function Update-DistributionList {
    Connect-ExchangeOnline 

    #Provide Distribution group you want to bulk-update
    $dlgroup = Read-Host "Please Enter Group address"

    #Import CSV of UPN's from C:\temp\users.csv and begin for-loop adding each to the distribution list above
    Import-CSV 'C:\temp\users.csv' | ForEach-Object {  
    $UPN=$_.UPN 
    Write-Progress -Activity "Adding $UPN to group… " 
    Add-DistributionGroupMember –Identity $dlgroup -Member $UPN  
    If($?)  
        {  
        Write-Host $UPN Successfully added -ForegroundColor Green 
        }  
        Else  
        {  
        Write-Host $UPN - Error occurred –ForegroundColor Red  
        }  
    } 
}





function Update-CalendarPermission {
    Connect-ExchangeOnline

    #Access Rights required for users in C:\temp\users.csv
    $AR = Read-Host "Please Enter Access Rights Required"

    #UPN of Calendar you're giving access to. 
    $Calendar = Read-Host "Enter Full Address of Calendar" 

    #Import CSV and begin for-loop adding each user into calendar provided above
    Import-Csv C:\temp\users.csv | ForEach-Object {
    Add-MailboxFolderPermission $Calendar":\Calendar" -User $_.UPN -AccessRights $AR
    If($?)  
        {  
        Write-Host $UPN Successfully added -ForegroundColor Green 
        }  
        Else  
        {  
        Write-Host $UPN - Error occurred –ForegroundColor Red  
        }  
    }     
}

